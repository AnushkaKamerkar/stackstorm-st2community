version: 1.0

description: Send update to given channel.

input:
  - channel
  - body
  - user
  - delta

tasks:
  buildMessage:
    action: st2community.build-text
    input:
      body: <% ctx(body) %>
      user: <% ctx(user) %>
      delta: <% ctx(delta) %> 
    next:
      - when: <% succeeded() %>
        do: 
          - sendMessage
        publish:
          - message: <% result().body %>
  sendMessage:
    action: slack.chat.postMessage
    input:
      channel: <% ctx(channel) %>
      text: <% ctx(message) %>
