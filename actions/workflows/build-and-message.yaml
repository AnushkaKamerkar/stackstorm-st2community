version: 1.0

description: Send update to given channel.

input:
  - github_users
  - channel
  - delta

tasks:
  buildMessage:
    action: st2community.build-text
    input:
      github_users: <% ctx(github_users) %>
      delta: <% ctx(delta) %>
    next:
      - when: <% succeeded() %>
        do:
          - sendMessage
        publish:
          - message: <% result().result.body %>
  sendMessage:
    action: slack.chat.postMessage
    input:
      channel: <% ctx(channel) %>
      text: <% ctx(message) %>
